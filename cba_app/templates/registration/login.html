{% extends "cba_app/base.html" %}

{% block content %}
    <div class="table-wrapper" style="max-width: 520px; margin: 0 auto;">
        <h2 style="margin-top:0;">Iniciar sesión</h2>
        <p class="text-muted" style="margin-top: 6px;">Accede al sistema para continuar.</p>

        {% if form.errors %}
            <div class="notice notice--error">Usuario o contraseña inválidos.</div>
        {% endif %}

        <form method="post" action="{% url 'cba_login' %}" style="margin-top: 14px;">
            {% csrf_token %}

            {% if next %}
                <input type="hidden" name="next" value="{{ next }}">
            {% endif %}

            <div style="display:grid; gap: 10px;">
                <div>
                    <label for="id_username" class="text-muted">Usuario</label>
                    <input id="id_username" name="username" type="text" class="cba-input" autocomplete="username" required>
                </div>

                <div>
                    <label for="id_password" class="text-muted">Contraseña</label>
                    <input id="id_password" name="password" type="password" class="cba-input" autocomplete="current-password" required>
                </div>

                <label class="text-muted" style="display:flex; align-items:center; gap: 8px; font-size: 13px;">
                    <input type="checkbox" id="togglePwLogin">
                    Mostrar contraseña
                </label>
            </div>

            <div style="display:flex; gap: 10px; align-items:center; margin-top: 14px;">
                <button type="submit" class="button">Ingresar</button>
                <a href="{% url 'cba_signup' %}" class="link-back" style="margin:0;">Crear cuenta</a>
            </div>
        </form>

        <script>
            (function () {
                var cb = document.getElementById('togglePwLogin');
                var pw = document.getElementById('id_password');
                if (!cb || !pw) return;
                cb.addEventListener('change', function () {
                    pw.type = cb.checked ? 'text' : 'password';
                });
            })();
        </script>
    </div>
{% endblock %}
